<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Daily Diary</title>

<style>
    body {
        margin: 0;
        font-family: Arial;
        display: flex;
        background: #d9b77c; /* vÃ ng nÃ¢u */
    }

    /* Panel lá»‹ch sá»­ */
    #historyPanel {
        width: 240px;
        background: #c9a46a;
        border-right: 2px solid #8b6b3f;
        padding: 10px;
        height: 100vh;
        overflow-y: auto;
        color: #3a2a17;
    }

    #historyTitle {
        font-size: 20px;
        font-weight: bold;
        margin-bottom: 10px;
        text-align: center;
    }

    .historyItem {
        padding: 8px;
        background: #f5deb3;
        border: 1px solid #b9935a;
        border-radius: 6px;
        margin-bottom: 10px;
        cursor: pointer;
        color: #3d2c1c;
    }
    .historyItem:hover {
        background: #ffe2ac;
    }

    /* Khu vá»±c chÃ­nh */
    #main {
        flex: 1;
        padding: 20px;
        background: #d9b77c;
    }

    #logo {
        width: 70px;
        cursor: pointer;
        margin-bottom: 15px;
    }

    #currentDate {
        font-size: 22px;
        font-weight: bold;
        color: #3b2a17;
        margin-bottom: 10px;
    }

    #note {
        width: 100%;
        height: 85vh;
        font-size: 18px;
        background: #f5deb3;
        border: 2px solid #b9935a;
        color: #3b2a17;
        padding: 10px;
        border-radius: 10px;
        resize: none;
    }
</style>
</head>

<body>

<!-- Lá»‹ch sá»­ -->
<div id="historyPanel">
    <div id="historyTitle">ðŸ“œ Lá»‹ch sá»­</div>
    <div id="historyList"></div>
</div>

<!-- Ná»™i dung chÃ­nh -->
<div id="main">
    <img id="logo" src="https://e7.pngegg.com/pngimages/268/859/png-clipart-yellow-autumn-leaf-color-leaf-watercolor-leaf-maple-leaf.png">
    
    <div id="currentDate"></div>
    <textarea id="note" placeholder="Viáº¿t nháº­t kÃ½ hÃ´m nay táº¡i Ä‘Ã¢y..."></textarea>
</div>

<script>
function getDateKey() {
    const now = new Date();
    return now.getFullYear() + "-" + (now.getMonth() + 1) + "-" + now.getDate();
}

function getFullTimestamp() {
    const now = new Date();
    return now.toLocaleString("vi-VN", { hour12: false });
}

let todayKey = getDateKey();
document.getElementById("currentDate").textContent = "ðŸ“… " + todayKey;

function loadToday() {
    let saved = localStorage.getItem("diary_" + todayKey);
    document.getElementById("note").value = saved ? saved : "";
}
loadToday();

document.getElementById("note").addEventListener("input", function () {
    localStorage.setItem("diary_" + todayKey, this.value);
});

document.getElementById("logo").addEventListener("click", function () {
    let content = document.getElementById("note").value.trim();
    if (content !== "") {
        saveHistory(todayKey, content);
    }
    document.getElementById("note").value = "";
    localStorage.setItem("diary_" + todayKey, "");
    loadHistory();
});

setInterval(() => {
    let current = getDateKey();

    if (current !== todayKey) {
        let oldContent = localStorage.getItem("diary_" + todayKey);
        if (oldContent && oldContent.trim() !== "") {
            saveHistory(todayKey, oldContent);
        }

        todayKey = current;
        document.getElementById("currentDate").textContent = "ðŸ“… " + todayKey;
        loadToday();
        loadHistory();
    }
}, 5000); 
function saveHistory(date, text) {
    let timestamp = getFullTimestamp();
    let key = "history_" + date + "_" + timestamp;
    localStorage.setItem(key, text);
}

function loadHistory() {
    let list = document.getElementById("historyList");
    list.innerHTML = "";

    Object.keys(localStorage)
        .filter(k => k.startsWith("history_"))
        .sort()
        .forEach(key => {
            let div = document.createElement("div");
            div.className = "historyItem";

            let parts = key.split("_");
            let date = parts[1];
            let time = parts[2] + " " + parts[3];

            div.textContent = date + " â€¢ " + time;

            div.onclick = () => {
                let content = localStorage.getItem(key).replace(/\n/g, "<br>");
                alert("ðŸ“… " + date + "\nðŸ•’ " + time + "\n\n" + content);
            };

            list.appendChild(div);
        });
}
loadHistory();

</script>

</body>
</html>
